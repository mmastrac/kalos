/* Generated by kalos_idl_compiler - DO NOT MODIFY */

#define K__pstring kalos_string*
#define K__string  kalos_string
#define K__pnumber kalos_int
#define K__number  kalos_int
#define K__pbool   kalos_int
#define K__bool    kalos_int
#define K__pobject kalos_object_ref*
#define K__object  kalos_object_ref
#define K__pany    kalos_value*
#define K__any     kalos_value

#define K__t_string KALOS_VALUE_STRING
#define K__t_number KALOS_VALUE_NUMBER
#define K__t_bool   KALOS_VALUE_BOOL
#define K__t_object KALOS_VALUE_OBJECT
#define K__t_any    KALOS_VALUE_ANY

#define K__clean_string(stack, x) kalos_string_release((kalos_state*)state, x);
#define K__clean_number(stack, x) ;
#define K__clean_bool  (stack, x) ;
#define K__clean_object(stack, x) kalos_object_release((kalos_state*)state, &x);
#define K__clean_any   (stack, x) kalos_clear((kalos_state*)state, x);
#define K__arg(n, x)     peek(stack, (n)-(x))
#define K__arg_string(x) &((x)->value.string)
#define K__arg_number(x) (x)->value.number
#define K__arg_bool(x)   (x)->value.number
#define K__arg_object(x) &((x)->value.object)
#define K__arg_any(x)    (x)

// id=0000:0001 name=init
void kalos_module_dispatch_test_trigger_init(kalos_run_state* state) {
	kalos_trigger(state, kalos_make_address(0x0, 0x1));
}

void kalos_module_dispatch_test_builtin(kalos_run_state* state, int function, int param_count, kalos_stack* stack, bool retval) {
	switch (function) {
	// id=1 name=print arg_count=0 binding=fn test_print
	case 1: {
		LOG("Invoke %s", "print");
		const int vararg_count = kalos_stack_vararg_count(stack);
		const int arg_count = 1 + vararg_count;
		kalos_stack_setup_0(state);
		test_print((void*)state, vararg_count, kalos_stack_vararg_start(stack, vararg_count));
		kalos_stack_cleanup(state, arg_count);
		break;
	}

	}
}

// id=0001:0001 name=with_args
void kalos_module_dispatch_test_test_trigger_with_args(kalos_run_state* state, K__pstring a0) {
	kalos_load_arg_string(state, 0, a0);
	kalos_trigger(state, kalos_make_address(0x1, 0x1));
}

// id=0001:0002 name=self_trigger
void kalos_module_dispatch_test_test_trigger_self_trigger(kalos_run_state* state, K__pstring a0, K__pobject a1) {
	kalos_load_arg_string(state, 0, a0);
	kalos_load_arg_object(state, 1, a1);
	kalos_trigger(state, kalos_make_address(0x1, 0x2));
}

//kalos_module_dispatch_test_test_object_a_props
bool kalos_module_dispatch_test_test_object_a_props_fn(kalos_run_state* state, kalos_object_ref* object, int function, int param_count, kalos_stack* stack) {
	switch (function) {
	// id=2 name=a binding=fn test_read_a
	case 2: {
		push_string(stack, test_read_a((void*)state, object));
		break;
	}
	// id=4 name=c binding=fn test_read_c
	case 4: {
		push_number(stack, test_read_c((void*)state, object));
		break;
	}
	// id=5 name=c binding=fn test_write_c
	case 5: {
		const int arg_count = 1;
		test_write_c((void*)state, object, K__arg_number(K__arg(arg_count, 1)));
		kalos_stack_cleanup(state, 1);
		break;
	}
	default: return false;
	}
	return true;
}

kalos_object_dispatch kalos_module_dispatch_test_test_object_a_props = {
	.dispatch_id = kalos_module_dispatch_test_test_object_a_props_fn
};

//kalos_module_dispatch_test_test_object_b_props
bool kalos_module_dispatch_test_test_object_b_props_fn(kalos_run_state* state, kalos_object_ref* object, int function, int param_count, kalos_stack* stack) {
	switch (function) {
	// id=2 name=a binding=fn test_read_a
	case 2: {
		push_string(stack, test_read_a((void*)state, object));
		break;
	}
	// id=6 name=b binding=fn test_read_b
	case 6: {
		push_string(stack, test_read_b((void*)state, object));
		break;
	}
	// id=4 name=c binding=fn test_read_c2
	case 4: {
		push_number(stack, test_read_c2((void*)state, object));
		break;
	}
	default: return false;
	}
	return true;
}

kalos_object_dispatch kalos_module_dispatch_test_test_object_b_props = {
	.dispatch_id = kalos_module_dispatch_test_test_object_b_props_fn
};

void kalos_module_dispatch_test_test(kalos_run_state* state, int function, int param_count, kalos_stack* stack, bool retval) {
	switch (function) {
	// id=1 name=read_write binding=fn test_read_write_read
	case 1: {
		push_number(stack, test_read_write_read((void*)state));
		break;
	}
	// id=2 name=read_write binding=fn test_read_write_write
	case 2: {
		const int arg_count = 1;
		test_read_write_write((void*)state, K__arg_number(K__arg(arg_count, 1)));
		kalos_stack_cleanup(state, 1);
		break;
	}
	// id=3 name=read_only binding=fn test_read_only_read
	case 3: {
		push_number(stack, test_read_only_read((void*)state));
		break;
	}
	// id=4 name=write_only binding=fn test_write_only_write
	case 4: {
		const int arg_count = 1;
		test_write_only_write((void*)state, K__arg_number(K__arg(arg_count, 1)));
		kalos_stack_cleanup(state, 1);
		break;
	}
	// id=5 name=add_one arg_count=1 binding=c @0 + 1
	case 5: {
		LOG("Invoke %s", "add_one");
		const int arg_count = 1;
		kalos_stack_setup_1(state, K__t_number);
		K__number x = ((K__arg_number(K__arg(arg_count, 1))) + 1);
		kalos_stack_cleanup(state, arg_count);
		if (retval) {
			push_number(stack, x);
		} else {
			K__clean_number(stack, x);
		}
		break;
	}

	// id=6 name=sum_numbers arg_count=0 binding=fn test_kalos_sum_numbers
	case 6: {
		LOG("Invoke %s", "sum_numbers");
		const int vararg_count = kalos_stack_vararg_count(stack);
		const int arg_count = 1 + vararg_count;
		kalos_stack_setup_0(state);
		K__number x = test_kalos_sum_numbers((void*)state, vararg_count, kalos_stack_vararg_start(stack, vararg_count));
		kalos_stack_cleanup(state, arg_count);
		if (retval) {
			push_number(stack, x);
		} else {
			K__clean_number(stack, x);
		}
		break;
	}

	// id=7 name=sum_numbers_2 arg_count=2 binding=fn test_kalos_sum_numbers_2
	case 7: {
		LOG("Invoke %s", "sum_numbers_2");
		const int vararg_count = kalos_stack_vararg_count(stack);
		const int arg_count = 3 + vararg_count;
		kalos_stack_setup_2(state, K__t_number, K__t_number);
		K__number x = test_kalos_sum_numbers_2((void*)state, K__arg_number(K__arg(arg_count, 1)), K__arg_number(K__arg(arg_count, 2)), vararg_count, kalos_stack_vararg_start(stack, vararg_count));
		kalos_stack_cleanup(state, arg_count);
		if (retval) {
			push_number(stack, x);
		} else {
			K__clean_number(stack, x);
		}
		break;
	}

	// id=8 name=concat arg_count=8 binding=fn test_kalos_concat
	case 8: {
		LOG("Invoke %s", "concat");
		const int arg_count = 8;
		kalos_stack_setup_8(state, K__t_string, K__t_string, K__t_string, K__t_string, K__t_string, K__t_string, K__t_string, K__t_string);
		K__string x = test_kalos_concat((void*)state, K__arg_string(K__arg(arg_count, 1)), K__arg_string(K__arg(arg_count, 2)), K__arg_string(K__arg(arg_count, 3)), K__arg_string(K__arg(arg_count, 4)), K__arg_string(K__arg(arg_count, 5)), K__arg_string(K__arg(arg_count, 6)), K__arg_string(K__arg(arg_count, 7)), K__arg_string(K__arg(arg_count, 8)));
		kalos_stack_cleanup(state, arg_count);
		if (retval) {
			push_string(stack, x);
		} else {
			K__clean_string(stack, x);
		}
		break;
	}

	// id=9 name=overloaded arg_count=1 binding=c 1
	case 9: {
		LOG("Invoke %s", "overloaded");
		const int arg_count = 1;
		kalos_stack_setup_1(state, K__t_any);
		K__number x = (1);
		kalos_stack_cleanup(state, arg_count);
		if (retval) {
			push_number(stack, x);
		} else {
			K__clean_number(stack, x);
		}
		break;
	}

	// id=12 name=trigger_self arg_count=2 binding=fn kalos_module_dispatch_test_test_trigger_self_trigger
	case 12: {
		LOG("Invoke %s", "trigger_self");
		const int arg_count = 2;
		kalos_stack_setup_2(state, K__t_string, K__t_object);
		kalos_module_dispatch_test_test_trigger_self_trigger((void*)state, K__arg_string(K__arg(arg_count, 1)), K__arg_object(K__arg(arg_count, 2)));
		kalos_stack_cleanup(state, arg_count);
		break;
	}

	// id=13 name=raw_c arg_count=2 binding=c @0*10+@1
	case 13: {
		LOG("Invoke %s", "raw_c");
		const int arg_count = 2;
		kalos_stack_setup_2(state, K__t_number, K__t_number);
		K__number x = ((K__arg_number(K__arg(arg_count, 1)))*10+(K__arg_number(K__arg(arg_count, 2))));
		kalos_stack_cleanup(state, arg_count);
		if (retval) {
			push_number(stack, x);
		} else {
			K__clean_number(stack, x);
		}
		break;
	}

	// id=14 name=make_a arg_count=0 binding=fn test_make_a
	case 14: {
		LOG("Invoke %s", "make_a");
		const int arg_count = 0;
		kalos_stack_setup_0(state);
		K__object x = test_make_a((void*)state);
		kalos_stack_cleanup(state, arg_count);
		if (retval) {
			push_object(stack, x);
		} else {
			K__clean_object(stack, x);
		}
		break;
	}

	// id=15 name=make_b arg_count=0 binding=fn test_make_b
	case 15: {
		LOG("Invoke %s", "make_b");
		const int arg_count = 0;
		kalos_stack_setup_0(state);
		K__object x = test_make_b((void*)state);
		kalos_stack_cleanup(state, arg_count);
		if (retval) {
			push_object(stack, x);
		} else {
			K__clean_object(stack, x);
		}
		break;
	}

	}
}

kalos_dispatch_fn kalos_module_dispatch_test_dispatch[] = {
	kalos_module_dispatch_test_builtin,
	kalos_module_dispatch_test_test,
};

#undef K__string
#undef K__number
#undef K__bool
#undef K__object
#undef K__any
